<!DOCTYPE html>
<html>
<head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="js/gyro.js"></script>
    <script>
        var nombre;
        $(document).ready(function(){
            $("#btn1").click(function(){
                $.ajax({
                    url: "../new"
                })
                        .done(function( data ) {
                            nombre = data;
                            $( "#identificador" ).text(data);
                        })
                        .fail(function(){
                            alert("error");
                        });
                var currentMousePos = { x: -1, y: -1 };
                setInterval(function(){
                    $(document).mousemove(function(event) {
                        currentMousePos.x = event.pageX;
                        currentMousePos.y = event.pageY;
                    });
                    $.ajax({
                        url: "../post/"+nombre,
                        data: currentMousePos
                    })
                            .done(function( data ) {
                                $( "#contador" ).text( JSON.stringify(currentMousePos))
                            })
                            .fail(function(){
                                alert("error");
                            });
                },1000)
            });

        });
    </script>
</head>
<body>

<p>ID: <strong id="identificador"> - </strong></p>
<p>Counter: <strong id="contador"> - </strong></p>
<button id="btn1">Conectar</button>

</body>
</html>
